<%# 
  –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–æ—Ä—ñ—ó (bucket elevator)
  –°—Ç–∏–ª—ñ—Å—Ç–∏–∫–∞ —Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥—ñ–±–Ω–∞ –¥–æ screw_conv.html.erb
  –î–æ–¥–∞–Ω–æ –ø–æ–ª—è: —Ç–∏–ø –Ω–æ—Ä—ñ—ó, –≤–∏—Å–æ—Ç–∞ –Ω–æ—Ä—ñ—ó, –≤–∏–±—ñ—Ä –º–æ—Ç–æ—Ä-—Ä–µ–¥—É–∫—Ç–æ—Ä–∞
%>

<div class="container-fluid py-4">
  <div class="row">
    <div class="col-12">
      <h1 class="text-center mb-4 text-primary">
        <i class="fas fa-cogs me-2"></i>
        –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–æ—Ä—ñ—ó
      </h1>
      <p class="text-center text-muted mb-5">
        –ü–∞—Ä–∞–º–µ—Ç—Ä–∏, —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ —Ç–∞ –ø—ñ–¥–±—ñ—Ä –º–æ—Ç–æ—Ä-—Ä–µ–¥—É–∫—Ç–æ—Ä–∞ –¥–ª—è –Ω–æ—Ä—ñ—ó
      </p>
    </div>
  </div>

  <div class="row">
    <!-- –õ—ñ–≤–∞ –ø–∞–Ω–µ–ª—å –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ -->
    <div class="col-lg-6">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0">
            <i class="fas fa-sliders-h me-2"></i>
            –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–æ—Ä—ñ—ó
          </h5>
        </div>
        <div class="card-body">
          <!-- –¢–∏–ø –Ω–æ—Ä—ñ—ó -->
          <div class="mb-4">
            <label for="noria-type" class="form-label fw-bold">
              <i class="fas fa-tags me-2"></i>
              –¢–∏–ø –Ω–æ—Ä—ñ—ó:
            </label>
            <select id="noria-type" class="form-select form-select-lg">
              <option value="–ù–ö–ó-10">–ù–ö–ó-10</option>
              <option value="–ù–ö–ó-25" selected>–ù–ö–ó-25</option>
              <option value="–ù–ö–ó-50">–ù–ö–ó-50</option>
              <option value="–ù–ö–ó-100">–ù–ö–ó-100</option>
              <option value="–ù–ö–ó-200">–ù–ö–ó-200</option>
            </select>
          </div>

          <!-- –í–∏—Å–æ—Ç–∞ –Ω–æ—Ä—ñ—ó -->
          <div class="mb-4">
            <label for="noria-height" class="form-label fw-bold">
              <i class="fas fa-ruler-vertical me-2"></i>
              –í–∏—Å–æ—Ç–∞ –Ω–æ—Ä—ñ—ó (–º):
            </label>
            <select id="noria-height" class="form-select">
              <option value="5">5</option>
              <option value="10" selected>10</option>
              <option value="15">15</option>
              <option value="20">20</option>
              <option value="25">25</option>
              <option value="30">30</option>
            </select>
          </div>

          <!-- –ú–æ—Ç–æ—Ä-—Ä–µ–¥—É–∫—Ç–æ—Ä -->
          <div class="mb-4">
            <label for="motor-reducer" class="form-label fw-bold">
              <i class="fas fa-industry me-2"></i>
              –ú–æ—Ç–æ—Ä-—Ä–µ–¥—É–∫—Ç–æ—Ä (–Ω–æ–º—ñ–Ω–∞–ª—å–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å, –∫–í—Ç):
            </label>
            <select id="motor-reducer" class="form-select">
              <option value="1.5">1.5 –∫–í—Ç</option>
              <option value="3" selected>3 –∫–í—Ç</option>
              <option value="5.5">5.5 –∫–í—Ç</option>
              <option value="7.5">7.5 –∫–í—Ç</option>
              <option value="11">11 –∫–í—Ç</option>
              <option value="15">15 –∫–í—Ç</option>
            </select>
          </div>

          <!-- –ö–Ω–æ–ø–∫–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É -->
          <div class="text-center">
            <button id="btn-rozrahunok" class="btn btn-success btn-lg px-5">
              <i class="fas fa-calculator me-2"></i>
              –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- –ü—Ä–∞–≤–∞ –ø–∞–Ω–µ–ª—å –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º -->
    <div class="col-lg-6">
      <!-- –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–æ—Ä—ñ—ó -->
      <div class="card shadow-sm mb-4">
        <div class="card-header bg-info text-white">
          <h5 class="mb-0">
            <i class="fas fa-image me-2"></i>
            –°—Ö–µ–º–∞ –Ω–æ—Ä—ñ—ó
          </h5>
        </div>
        <div class="card-body text-center">
          <img id="noria-image" 
               src="<%= asset_path('icon.png') %>" 
               alt="–°—Ö–µ–º–∞ –Ω–æ—Ä—ñ—ó" 
               class="img-fluid rounded shadow-sm"
               style="max-height: 300px;">
        </div>
      </div>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤ -->
      <div class="card shadow-sm">
        <div class="card-header bg-success text-white">
          <h5 class="mb-0">
            <i class="fas fa-chart-line me-2"></i>
            –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤
          </h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-12">
              <div class="result-item mb-3 p-3 bg-light rounded">
                <strong>–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –Ω–æ—Ä—ñ—ó:</strong>
                <span id="produktyvnist" class="text-primary fs-5">0</span> —Ç/–≥–æ–¥
              </div>
            </div>
            <div class="col-12">
              <div class="result-item mb-3 p-3 bg-light rounded">
                <strong>–ù–µ–æ–±—Ö—ñ–¥–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å:</strong>
                <span id="power-required" class="text-primary fs-5">0</span> –∫–í—Ç
              </div>
            </div>
            <div class="col-12">
              <div class="result-item mb-3 p-3 bg-light rounded">
                <strong>–ê–¥–µ–∫–≤–∞—Ç–Ω—ñ—Å—Ç—å –≤–∏–±–æ—Ä—É –º–æ—Ç–æ—Ä-—Ä–µ–¥—É–∫—Ç–æ—Ä–∞:</strong>
                <span id="motor-adequacy" class="text-primary fs-5">‚Äî</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- –ü–æ–ª–µ –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –≤—Å—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ -->
  <div class="row mt-4">
    <div class="col-12 text-center">
      <button id="btn-show-all" class="btn btn-outline-primary">
        <i class="fas fa-list me-2"></i>
        –ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
      </button>
    </div>
  </div>
</div>

<style>
/* CSS —Å—Ç–∏–ª—ñ –¥–ª—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –Ω–æ—Ä—ñ—ó */
.container-fluid {
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
  min-height: 100vh;
}

.card {
  border: none;
  border-radius: 15px;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(0,0,0,0.15) !important;
}

.card-header {
  border-radius: 15px 15px 0 0 !important;
  border: none;
}

.form-control, .form-select {
  border-radius: 10px;
  border: 2px solid #e9ecef;
  transition: all 0.3s ease;
}

.form-control:focus, .form-select:focus {
  border-color: #007bff;
  box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.25);
  transform: scale(1.02);
}

.btn {
  border-radius: 25px;
  transition: all 0.3s ease;
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.result-item {
  border-left: 4px solid #28a745;
  transition: all 0.3s ease;
}

.result-item:hover {
  background-color: #e8f5e8 !important;
  transform: translateX(5px);
}

.text-primary {
  color: #007bff !important;
}

.bg-primary {
  background: linear-gradient(45deg, #007bff, #0056b3) !important;
}

.bg-success {
  background: linear-gradient(45deg, #28a745, #1e7e34) !important;
}

.bg-info {
  background: linear-gradient(45deg, #17a2b8, #117a8b) !important;
}

#noria-image {
  transition: all 0.3s ease;
  border: 3px solid #dee2e6;
}

#noria-image:hover {
  transform: scale(1.05);
  border-color: #007bff;
}

.form-label {
  color: #495057;
  font-weight: 500;
}

.border-bottom {
  border-bottom: 2px solid #dee2e6 !important;
}

/* –ê–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.result-updated {
  animation: fadeInUp 0.5s ease;
}
</style>

<script>
// –î–∞–Ω—ñ –¥–ª—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –Ω–æ—Ä—ñ—ó
const noriaData = {
  type: '–ù–ö–ó-25',
  height: 10,
  motorReducerPower: 3,
  produktyvnist: 0,
  powerRequired: 0,
  motorAdequacy: '‚Äî'
};

// –í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Ç–∏–ø—É –Ω–æ—Ä—ñ—ó –¥–æ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ (—Ç/–≥–æ–¥)
const typeCapacityMap = {
  '–ù–ö–ó-10': 10,
  '–ù–ö–ó-25': 25,
  '–ù–ö–ó-50': 50,
  '–ù–ö–ó-100': 100,
  '–ù–ö–ó-200': 200
};

// –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è (–∑–∞ —Ç–∏–ø–æ–º –Ω–æ—Ä—ñ—ó, –ø–æ–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä)
function onovytyZobrazhennya() {
  const imageElement = document.getElementById('noria-image');
  imageElement.style.opacity = '0';
  setTimeout(() => { imageElement.style.opacity = '1'; }, 100);
}

// –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
function rozrahuvaty() {
  const q = typeCapacityMap[noriaData.type] || 0; // —Ç/–≥–æ–¥
  const H = Number(noriaData.height) || 0; // –º
  const k_loss = 1.5; // –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –Ω–∞ –≤—Ç—Ä–∞—Ç–∏, —Ç–µ—Ä—Ç—è, –ö–ö–î

  // –°–ø—Ä–æ—â–µ–Ω–∞ —Ñ–æ—Ä–º—É–ª–∞ –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ: P ‚âà (Q * H) / 367, –∫–í—Ç; –º–Ω–æ–∂–∏–º–æ –Ω–∞ k_loss
  noriaData.produktyvnist = q;
  noriaData.powerRequired = ((q * H) / 367) * k_loss;

  // –ê–¥–µ–∫–≤–∞—Ç–Ω—ñ—Å—Ç—å –≤–∏–±–æ—Ä—É –º–æ—Ç–æ—Ä-—Ä–µ–¥—É–∫—Ç–æ—Ä–∞
  noriaData.motorAdequacy = (noriaData.motorReducerPower >= noriaData.powerRequired)
    ? '–î–æ—Å—Ç–∞—Ç–Ω—å–æ'
    : '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ';

  onovytyRezultaty();
}

// –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –Ω–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ
function onovytyRezultaty() {
  document.getElementById('produktyvnist').textContent = noriaData.produktyvnist.toFixed(0);
  document.getElementById('power-required').textContent = noriaData.powerRequired.toFixed(2);
  document.getElementById('motor-adequacy').textContent = noriaData.motorAdequacy;

  document.querySelectorAll('.result-item').forEach(item => {
    item.classList.add('result-updated');
    setTimeout(() => item.classList.remove('result-updated'), 500);
  });
}

// –ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
function pokazatyVsiZminni() {
  const alertMessage = `
üîß –ü–ê–†–ê–ú–ï–¢–†–ò –ù–û–†–Ü–á üîß

‚Ä¢ –¢–∏–ø –Ω–æ—Ä—ñ—ó: ${noriaData.type}
‚Ä¢ –í–∏—Å–æ—Ç–∞: ${noriaData.height} –º
‚Ä¢ –ú–æ—Ç–æ—Ä-—Ä–µ–¥—É–∫—Ç–æ—Ä: ${noriaData.motorReducerPower} –∫–í—Ç

üìä –†–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:
‚Ä¢ –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å: ${noriaData.produktyvnist.toFixed(0)} —Ç/–≥–æ–¥
‚Ä¢ –ù–µ–æ–±—Ö—ñ–¥–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å: ${noriaData.powerRequired.toFixed(2)} –∫–í—Ç
‚Ä¢ –ê–¥–µ–∫–≤–∞—Ç–Ω—ñ—Å—Ç—å: ${noriaData.motorAdequacy}
  `;
  alert(alertMessage);
}

// –û–Ω–æ–≤–∏—Ç–∏ –æ–¥–Ω—É –∑–º—ñ–Ω–Ω—É —ñ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏
function onovytyZminnu(nazvaZminnoyi, znachennya) {
  noriaData[nazvaZminnoyi] = znachennya;
  rozrahuvaty();
}

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
document.addEventListener('DOMContentLoaded', function() {
  console.log('üöÄ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–æ—Ä—ñ—ó —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ');

  // –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π
  document.getElementById('noria-type').addEventListener('change', function() {
    onovytyZminnu('type', this.value);
    onovytyZobrazhennya();
  });

  document.getElementById('noria-height').addEventListener('change', function() {
    onovytyZminnu('height', parseFloat(this.value) || 0);
  });

  document.getElementById('motor-reducer').addEventListener('change', function() {
    onovytyZminnu('motorReducerPower', parseFloat(this.value) || 0);
  });

  document.getElementById('btn-rozrahunok').addEventListener('click', function() {
    rozrahuvaty();
    pokazatyVsiZminni();
  });

  document.getElementById('btn-show-all').addEventListener('click', function() {
    pokazatyVsiZminni();
  });

  // –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫
  rozrahuvaty();
  console.log('‚úÖ –í—Å—ñ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –¥–æ–¥–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ');
});
</script>
